' COMPUTING THE LINEAR REGRESSION WITH BASIC
'
' Antti J Ylikoski 2017-03-07 MikroBITTI-lehdelle
'
' COMPUTE HOW MANY X/Y PAIRS THERE ARE THERE

DIM TRUE AS INTEGER
DIM NRDATA AS INTEGER
DIM X AS DOUBLE
DIM Y AS DOUBLE
DIM INDX AS INTEGER

TRUE = 1
NRDATA = 0
ON ERROR GOTO 100
WHILE TRUE
    READ X, Y
    NRDATA = NRDATA + 1
WEND

100 REM

PRINT "THE NUMBER OF THE DATA ARE"; NRDATA
PRINT
PRINT "THE DATA ARE:"
PRINT

RESTORE

FOR INDX = 1 TO NRDATA
    READ X, Y
    PRINT "X, Y", X, Y
NEXT INDX

PRINT

DIM SIGMAXY AS DOUBLE
DIM SIGMAX AS DOUBLE
DIM SIGMAY AS DOUBLE
DIM SIGMAX2 AS DOUBLE


SIGMAXY = 0
SIGMAX = 0
SIGMAY = 0
SIGMAX2 = 0

RESTORE

FOR INDX = 1 TO NRDATA
    READ X, Y
    SIGMAXY = SIGMAXY + X * Y
    SIGMAX = SIGMAX + X
    SIGMAY = SIGMAY + Y
    SIGMAX2 = SIGMAX2 + X ^ 2
NEXT INDX


DIM M AS DOUBLE
DIM B AS DOUBLE

M = (SIGMAXY - SIGMAX * SIGMAY / NRDATA) / (SIGMAX2 - SIGMAX ^ 2 / NRDATA)

B = (SIGMAY - M * SIGMAX) / NRDATA

DIM MEANX AS DOUBLE
DIM MEANY AS DOUBLE

DIM DX AS DOUBLE
DIM DY AS DOUBLE

MEANX = SIGMAX / NRDATA
MEANY = SIGMAY / NRDATA

DX = 0
DY = 0

RESTORE

FOR INDX = 1 TO NRDATA
    READ X, Y
    DX = DX + (X - MEANX) ^ 2
    DY = DY + (Y - MEANY) ^ 2
NEXT INDX

DIM SDX AS DOUBLE
DIM SDY AS DOUBLE

SDX = SQR(DX / (NRDATA - 1))
SDY = SQR(DY / (NRDATA - 1))
DIM R AS DOUBLE

R = M * SDX / SDY


PRINT "THE MEAN OF THE X VALUES:", MEANX
PRINT "THE MEAN OF THE Y VALUES:", MEANY
PRINT
PRINT "THE SD OF THE X VALUES:", SDX
PRINT "THE SD OF THE Y VALUES:", SDY
PRINT
PRINT "Y = M * X + B, WHERE"
PRINT
PRINT "M = ", M
PRINT "B = ", B
PRINT
PRINT "THE CORRELATION COEFFICIENT R =", R

DATA 0.0,0.5
DATA 2.0,1.0
DATA 1.0,1.0
DATA 5.0,3.0
DATA 10.0,7.0

END

